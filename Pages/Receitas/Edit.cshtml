@page
@using static ChefsTable.Models.Receita
@model Chef_sTable.Pages.Receitas.EditModel

<link rel="stylesheet" href="~/css/criar-receita.css" />

@{
    ViewData["Title"] = "Editar Receita";
}

<h1 class="page-title">Editar receita</h1>

<form method="post" enctype="multipart/form-data" class="form-receita">

    <input type="hidden" asp-for="Receita.Id" />

    <div asp-validation-summary="ModelOnly" class="text-danger"></div>

    <!-- INFORMAÇÕES BÁSICAS -->
    <section class="form-section">
        <h2>Informações básicas</h2>

        <div class="form-group">
            <label asp-for="Receita.Titulo"></label>
            <input asp-for="Receita.Titulo" class="form-control" />
            <span asp-validation-for="Receita.Titulo" class="text-danger"></span>
        </div>

        <div class="form-group">
            <label asp-for="Receita.Descricao"></label>
            <textarea asp-for="Receita.Descricao"
                      class="form-control"
                      rows="3"></textarea>
            <span asp-validation-for="Receita.Descricao" class="text-danger"></span>
        </div>
    </section>

    <!-- INGREDIENTES E PREPARO -->
    <section class="form-section">
        <h2>Ingredientes e preparo</h2>

        <div class="form-group">
            <label asp-for="Receita.Ingredientes"></label>
            <textarea asp-for="Receita.Ingredientes"
                      class="form-control"
                      rows="4"></textarea>
            <span asp-validation-for="Receita.Ingredientes" class="text-danger"></span>
        </div>

        <div class="form-group">
            <label asp-for="Receita.ModoPreparo"></label>
            <textarea asp-for="Receita.ModoPreparo"
                      class="form-control"
                      rows="8"></textarea>
            <span asp-validation-for="Receita.ModoPreparo" class="text-danger"></span>
        </div>

        <div class="form-group">
            <label asp-for="Receita.TempoPreparo">Tempo de preparo</label>

            <div class="tempo-wrapper">
                <input asp-for="Receita.TempoPreparo"
                       type="number"
                       min="1"
                       class="form-control" />
                <span class="tempo-label">minutos</span>
            </div>

            <span asp-validation-for="Receita.TempoPreparo" class="text-danger"></span>
        </div>
    </section>

    <!-- CLASSIFICAÇÃO -->
    <section class="form-section">
        <h2>Classificação</h2>

        <div class="form-group">
            <label asp-for="Receita.Dificuldade"></label>
            <select asp-for="Receita.Dificuldade"
                    class="form-control"
                    asp-items="Html.GetEnumSelectList<DificuldadeNivel>()">
            </select>
        </div>

        <div class="form-group">
            <label asp-for="Receita.Tags"></label>
            <select asp-for="Receita.Tags"
                    class="form-control"
                    asp-items="Html.GetEnumSelectList<Tag>()">
            </select>
        </div>

        <div class="form-group">
            <label asp-for="Receita.CategoriaId"></label>
            <select asp-for="Receita.CategoriaId"
                    asp-items="Model.CategoriasSL"
                    class="form-control">
                <option value="">Selecione uma categoria</option>
            </select>
        </div>
    </section>

    <!-- IMAGENS -->
    <section class="form-section">
        <h2>Imagens da receita</h2>
        <h7>Toque na imagem que deseja deletar</h7>

        @if (Model.ImagensAtuais.Any())
        {
            <div class="preview-imagens">
                @foreach (var foto in Model.ImagensAtuais)
                {
                    <div class="position-relative">
                        <img src="@foto.Url" class="preview-img" />

                        <input type="checkbox"
                               name="ImagensRemovidas"
                               value="@foto.Id"
                               class="position-absolute top-0 end-0" />
                    </div>
                }
            </div>
        }

        <input type="file"
               class="form-control"
               name="Imagens"
               multiple
               accept="image/*"
               onchange="previewImagens(this)" />

        <div id="preview" class="preview-imagens"></div>
    </section>

    <button type="submit" class="bt-publicar">
        Salvar alterações
    </button>
</form>

<a asp-page="/Usuarios/Details" class="link-voltar">← Voltar para o perfil</a>